
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>7.1. Moving in Three Dimensions &#8212; Introduction to Robotics and Perception</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/style.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="7.2. Multi-rotor Aircraft" href="S72_drone_actions.html" />
    <link rel="prev" title="7. Autonomous Drones in 3D" href="S70_drone_intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-312077-7', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Introduction to Robotics and Perception</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction to Robotics and Perception
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="S10_introduction.html">
   1. Introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="S11_intro_state.html">
     1.1. Representing State
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S12_intro_actions.html">
     1.2. Robot Actions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S13_intro_sensing.html">
     1.3. Sensing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S14_intro_perception.html">
     1.4. Perception
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S15_intro_decision.html">
     1.5. Planning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S16_intro_learning.html">
     1.6. Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="S20_sorter_intro.html">
   2. A Trash Sorting Robot
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="S21_sorter_state.html">
     2.1. Modeling the World State
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S22_sorter_actions.html">
     2.2. Actions for Sorting Trash
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S23_sorter_sensing.html">
     2.3. Sensors for Sorting Trash
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S24_sorter_perception.html">
     2.4. Perception
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S25_sorter_decision_theory.html">
     2.5. Decision Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S26_sorter_learning.html">
     2.6. Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="S30_vacuum_intro.html">
   3. A Robot Vacuum Cleaner
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="S31_vacuum_state.html">
     3.1. Modeling the State of the Vacuum Cleaning Robot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S32_vacuum_actions.html">
     3.2. Actions over time
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S33_vacuum_sensing.html">
     3.3. Dynamic Bayes Nets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S34_vacuum_perception.html">
     3.4. Perception with Graphical Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S35_vacuum_decision.html">
     3.5. Markov Decision Processes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S36_vacuum_RL.html">
     3.6. Reinforcement Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="S40_logistics_intro.html">
   4. Warehouse Robots in 2D
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="S41_logistics_state.html">
     4.1. Continuous State
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S42_logistics_actions.html">
     4.2. Moving in 2D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S43_logistics_sensing.html">
     4.3. Sensor Models with Continuous State
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S44_logistics_perception.html">
     4.4. Localization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S45_logistics_planning.html">
     4.5. Planning for Logistics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S46_logistics_learning.html">
     4.6. Some System Identification
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="S50_diffdrive_intro.html">
   5. A Mobile Robot With Simple Kinematics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="S51_diffdrive_state.html">
     5.1. State Space for a Differential Drive Robot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S52_diffdrive_actions.html">
     5.2. Motion Model for the Differential Drive Robot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S53_diffdrive_sensing.html">
     5.3. Robot Vision
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S54_diffdrive_perception.html">
     5.4. Computer Vision 101
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S55_diffdrive_planning.html">
     5.5. Path Planning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S56_diffdrive_learning.html">
     5.6. Deep Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="S60_driving_intro.html">
   6. Autonomous Vehicles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="S61_driving_state.html">
     6.1. Planar Geometry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S62_driving_actions.html">
     6.2. Kinematics for Driving
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S63_driving_sensing.html">
     6.3. Sensing for Autonomous Vehicles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S64_driving_perception.html">
     6.4. SLAM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S65_driving_planning.html">
     6.5. Planning for Autonomous Driving.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S66_driving_DRL.html">
     6.6. Deep Reinforcement Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="S70_drone_intro.html">
   7. Autonomous Drones in 3D
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     7.1. Moving in Three Dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S72_drone_actions.html">
     7.2. Multi-rotor Aircraft
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S73_drone_sensing.html">
     7.3. Sensing for Drones
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S74_drone_perception.html">
     7.4. Visual SLAM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="S75_drone_planning.html">
     7.5. Trajectory Optimization
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/S71_drone_state.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/gtbook/robotics"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/gtbook/robotics/issues/new?title=Issue%20on%20page%20%2FS71_drone_state.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/gtbook/robotics/main?urlpath=tree/S71_drone_state.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rotations-in-3d-aka-so-3">
   7.1.1. Rotations in 3D aka SO(3)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-rigid-transforms-aka-se-3">
   7.1.2. 3D Rigid transforms aka SE(3)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-group-se-3-in-gtsam">
   7.1.3. The Group
   <span class="math notranslate nohighlight">
    \(SE(3)\)
   </span>
   in GTSAM
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#angular-velocity">
   7.1.4. Angular Velocity
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Moving in Three Dimensions</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rotations-in-3d-aka-so-3">
   7.1.1. Rotations in 3D aka SO(3)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-rigid-transforms-aka-se-3">
   7.1.2. 3D Rigid transforms aka SE(3)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-group-se-3-in-gtsam">
   7.1.3. The Group
   <span class="math notranslate nohighlight">
    \(SE(3)\)
   </span>
   in GTSAM
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#angular-velocity">
   7.1.4. Angular Velocity
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <p><a href="https://colab.research.google.com/github/gtbook/robotics/blob/main/S71_drone_state.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<div class="tex2jax_ignore mathjax_ignore section" id="moving-in-three-dimensions">
<h1><span class="section-number">7.1. </span>Moving in Three Dimensions<a class="headerlink" href="#moving-in-three-dimensions" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>Motion in 3D has 6 DOF.</p>
</div></blockquote>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
<div align='center'>
<img src='https://github.com/gtbook/robotics/blob/main/Art/steampunk/S71-Autonomous%20camera%20drone-02.jpg?raw=1' style='height:256 width:100%'/>
</div>
</div></div>
</div>
<p>In Section 6.1, we introduced <span class="math notranslate nohighlight">\(SE(2)\)</span>, and showed how matrices can be used to represent both
rotation and translation in two dimensions.
At that time, we promised that this could be easily generalized to the case of rotation and
translation in three dimensions.  In this section, we deliver on that promise, and introduce
<span class="math notranslate nohighlight">\(SO(3)\)</span> and <span class="math notranslate nohighlight">\(SE(3)\)</span>.</p>
<p>In addition to representing the pose of an object in 3D, for the case of drones, we are also interested in
representing velocity.
This includes the both the linear velocity of the drone, which corresponds to the velocity
of the origin of the body-attached frame, as well as the rate of change in the orientation of the
body-attached frame.</p>
<div class="section" id="rotations-in-3d-aka-so-3">
<h2><span class="section-number">7.1.1. </span>Rotations in 3D aka SO(3)<a class="headerlink" href="#rotations-in-3d-aka-so-3" title="Permalink to this headline">¶</a></h2>
<p>In Section 6.1, we constructed the rotation matrix <span class="math notranslate nohighlight">\(R^0_1 \in SO(2)\)</span>
by projecting the axes of Frame 1 onto Frame 0.
The extension to 3D is indeed straightforward.
Again, we merely project the axes of Frame 1 onto Frame 0,
but in this case, each frame is equipped with a <span class="math notranslate nohighlight">\(z\)</span>-axis:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
R_{1}^{0}
=\begin{bmatrix}
x_1 \cdot x_0 &amp; y_1 \cdot x_0 &amp; z_1 \cdot x_0 \\
x_1 \cdot y_0 &amp; y_1 \cdot y_0 &amp; z_1 \cdot y_0 \\
x_1 \cdot z_0 &amp; y_1 \cdot z_0 &amp; z_1 \cdot z_0 \\
\end{bmatrix}
\end{split}\]</div>
<p>The expression for rotational coordinate transformations is now exactly the
same as in Chapter 6.
Given a point <span class="math notranslate nohighlight">\(p\)</span> with coordinates expressed relative to the body-attached
frame, we compute its coordinates in frame <span class="math notranslate nohighlight">\(s\)</span>:</p>
<div class="math notranslate nohighlight">
\[
p^s = R^s_b p^b
\]</div>
<p>Extending the semantics of <span class="math notranslate nohighlight">\(SO(2)\)</span> to <span class="math notranslate nohighlight">\(SO(3)\)</span>,
the columns
of <span class="math notranslate nohighlight">\(R_{b}^{s}\)</span> represent the axes of frame <span class="math notranslate nohighlight">\(B\)</span> in the <span class="math notranslate nohighlight">\(S\)</span> coordinate
frame:</p>
<div class="math notranslate nohighlight">
\[
R_{b}^{s}=\left[\begin{array}{ccc}
\hat{x}_{b}^{s} &amp; \hat{y}_{b}^{s} &amp; \hat{z}_{b}^{s}\end{array}\right]
\]</div>
<p>The 3D rotations together with composition constitute the <strong>special
orthogonal group</strong> <span class="math notranslate nohighlight">\(SO(3)\)</span>. It is made up of all <span class="math notranslate nohighlight">\(3\times3\)</span> orthonormal
matrices with determinant <span class="math notranslate nohighlight">\(+1\)</span>, with matrix multiplication implementing
composition.
However, <em>3D rotations do not commute</em>, i.e., in general <span class="math notranslate nohighlight">\(R_{2}R_{1}\neq R_{1}R_{2}\)</span>.</p>
<p>It is often useful to refer to rotations about one of the coordinate axes.
These basic rotation matrices are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
R_{x,\phi}
=\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; \cos \phi &amp; - \sin \phi \\
0 &amp; \sin \phi &amp; \cos \phi 
\end{bmatrix}
~~~
R_{y,\theta}
=\begin{bmatrix}
\cos \theta &amp;      0   &amp; \sin \theta \\
0            &amp;     1   &amp;  0 \\
-\sin \theta &amp; 0       &amp; \cos \theta
\end{bmatrix}
~~~
R_{z,\psi}
=\begin{bmatrix}
\cos \psi &amp;-\sin \psi &amp; 0 \\
\sin \psi &amp;\cos \psi &amp; 0 \\
0 &amp; 0   &amp;  1
\end{bmatrix}
\end{split}\]</div>
<p>Note, in particular, the form of <span class="math notranslate nohighlight">\(R_{z,\psi}\)</span>, the rotation about the <span class="math notranslate nohighlight">\(z\)</span>-axis.
The upper-left <span class="math notranslate nohighlight">\(2\times 2\)</span> block of this matrix is exactly the rotation matrix <span class="math notranslate nohighlight">\(R \in SO(2)\)</span>
as introduced in Section 6.1.
This can be understood by realizing that rotation in the <span class="math notranslate nohighlight">\(xy\)</span> plane is actually
a rotation about an implicit <span class="math notranslate nohighlight">\(z\)</span>- axis that points “out of the page.”</p>
</div>
<div class="section" id="d-rigid-transforms-aka-se-3">
<h2><span class="section-number">7.1.2. </span>3D Rigid transforms aka SE(3)<a class="headerlink" href="#d-rigid-transforms-aka-se-3" title="Permalink to this headline">¶</a></h2>
<p>In a similar way, we can immediately extend <span class="math notranslate nohighlight">\(SE(2)\)</span> to the case
of rotation and translation in 3D.
Suppose the point <span class="math notranslate nohighlight">\(p\)</span> is rigidly attached to frame <span class="math notranslate nohighlight">\(b\)</span>, and
we wish to determine its coordinates with respect to the reference frame <span class="math notranslate nohighlight">\(s\)</span>.
If the coordinates of <span class="math notranslate nohighlight">\(p\)</span> with respect to frame <span class="math notranslate nohighlight">\(b\)</span> are given by <span class="math notranslate nohighlight">\(p^b\)</span>,
then</p>
<div class="math notranslate nohighlight">
\[
p^{s}=R_{b}^{s}p^{b}+t_{b}^{s}
\]</div>
<p>in which <span class="math notranslate nohighlight">\(R^s_b \in SO(3)\)</span> is the rotation matrix that specifies the orientation
of frame <span class="math notranslate nohighlight">\(b\)</span> w.r.t. frame <span class="math notranslate nohighlight">\(s\)</span>,
and  <span class="math notranslate nohighlight">\(t^s_b \in \mathbb{R}^3\)</span> gives the location of the origin
of frame <span class="math notranslate nohighlight">\(b\)</span> w.r.t. frame <span class="math notranslate nohighlight">\(s\)</span> (specified in the coordinates of frame <span class="math notranslate nohighlight">\(s\)</span>).</p>
<p>We denote this transform by
<span class="math notranslate nohighlight">\(T_{b}^{s}\doteq\left(R_{b}^{s},\,t_{b}^{s}\right)\)</span>. The <strong>special
Euclidean group</strong> <span class="math notranslate nohighlight">\(SE(3)\)</span>, with the group operation defined similarly as in the previous chapter.
Moreover, the group <span class="math notranslate nohighlight">\(SE(3)\)</span> can be viewed as a subgroup of the general linear group
<span class="math notranslate nohighlight">\(GL(4)\)</span> of degree 4, by embedding the rotation and translation into a
<span class="math notranslate nohighlight">\(4\times4\)</span> invertible matrix defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
T_{b}^{s}=\begin{bmatrix}
R_{b}^{s} &amp; t_{b}^{s}\\
0 &amp; 1
\end{bmatrix}
\end{split}\]</div>
<p>Again, by embedding 3D points in a four-vector, a
3D rigid transform acting on a point can be implemented by matrix-vector
multiplication:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
R_{b}^{s} &amp; t_{b}^{s}\\
0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
p^{b}\\
1
\end{bmatrix}
=\begin{bmatrix}
R_{b}^{s}p^{b}+t_{b}^{s}\\
1
\end{bmatrix}
\end{split}\]</div>
</div>
<div class="section" id="the-group-se-3-in-gtsam">
<h2><span class="section-number">7.1.3. </span>The Group <span class="math notranslate nohighlight">\(SE(3)\)</span> in GTSAM<a class="headerlink" href="#the-group-se-3-in-gtsam" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Pose3</span></code> is a non-commutative group which acts on <code class="docutils literal notranslate"><span class="pre">Point3</span></code>.</p>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(SE(3)\)</span> is also a group, as the following properties all hold:</p>
<ol class="simple">
<li><p><strong>Closure</strong>: For all transforms <span class="math notranslate nohighlight">\(T, T' \in SE(3)\)</span>, their product is also in <span class="math notranslate nohighlight">\(SE(3)\)</span>, i.e., <span class="math notranslate nohighlight">\(T T' \in SE(3)\)</span>.</p></li>
<li><p><strong>Identity Element</strong>: The <span class="math notranslate nohighlight">\(4\times 4\)</span> identity matrix <span class="math notranslate nohighlight">\(I\)</span> is included in the group, and for
all <span class="math notranslate nohighlight">\(T \in SE(3)\)</span> we have <span class="math notranslate nohighlight">\(T I = I T = T\)</span>.</p></li>
<li><p><strong>Inverse</strong>: For every <span class="math notranslate nohighlight">\(T \in SE(3)\)</span> there exists <span class="math notranslate nohighlight">\(T^{-1} \in SE(3)\)</span> such that <span class="math notranslate nohighlight">\(T^{-1}T = T T^{-1} = I\)</span>.</p></li>
<li><p><strong>Associativity</strong>: For all <span class="math notranslate nohighlight">\(T_1, T_2, T_3 \in SE(3)\)</span>, <span class="math notranslate nohighlight">\((T_1 T_2) T_3 = T_1 (T_2 T_3)\)</span>.</p></li>
</ol>
<p>3D rigid transforms do <em>not</em> commute. The inverse <span class="math notranslate nohighlight">\(T^{-1}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
T^{-1} = \begin{bmatrix}R &amp; d\\0_2 &amp; 1\end{bmatrix}^{-1}
 = \begin{bmatrix}R^T &amp; -R^T d\\0_2 &amp; 1\end{bmatrix}
\end{split}\]</div>
<p>Again, all of this is built into GTSAM, where both 3D poses and 3D rigid transforms are represented by the type <code class="docutils literal notranslate"><span class="pre">Pose3</span></code>, with rotation matrices represented by <code class="docutils literal notranslate"><span class="pre">Rot3</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Rot3</span><span class="o">.</span><span class="n">Yaw</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span> <span class="c1"># rotation around Z-axis by 20 degrees</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Pose3</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;3D Pose </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2"> corresponding to transformation matrix:</span><span class="se">\n</span><span class="si">{</span><span class="n">T</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3D Pose R: [
	-0.720878, -0.693062, 0;
	0.693062, -0.720878, 0;
	0, 0, 1
]
t: 1 2 3
 corresponding to transformation matrix:
[[-0.72087779 -0.6930622   0.          1.        ]
 [ 0.6930622  -0.72087779  0.          2.        ]
 [ 0.          0.          1.          3.        ]
 [ 0.          0.          0.          1.        ]]
</pre></div>
</div>
</div>
</div>
<p>3D transforms form a <em>non-commutative</em> group, as demonstrated here in code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="n">T</span><span class="p">,</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Pose3</span><span class="p">))</span> <span class="c1"># closure</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Pose3</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="n">I</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">))</span> <span class="c1"># identity</span>
<span class="nb">print</span><span class="p">((</span><span class="n">T</span> <span class="o">*</span> <span class="n">T</span><span class="o">.</span><span class="n">inverse</span><span class="p">())</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">))</span> <span class="c1"># inverse</span>
<span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">T3</span> <span class="o">=</span> <span class="n">T</span><span class="p">,</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Pose3</span><span class="p">(</span><span class="n">gtsam</span><span class="o">.</span><span class="n">Rot3</span><span class="o">.</span><span class="n">Roll</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Pose3</span><span class="p">(</span><span class="n">gtsam</span><span class="o">.</span><span class="n">Rot3</span><span class="o">.</span><span class="n">Roll</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(((</span><span class="n">T1</span> <span class="o">*</span> <span class="n">T2</span><span class="p">)</span><span class="o">*</span> <span class="n">T3</span><span class="p">)</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">T1</span> <span class="o">*</span> <span class="p">(</span><span class="n">T2</span> <span class="o">*</span> <span class="n">T3</span><span class="p">),</span> <span class="mf">1e-9</span><span class="p">))</span> <span class="c1"># associative</span>
<span class="nb">print</span><span class="p">((</span><span class="n">T1</span> <span class="o">*</span> <span class="n">T2</span><span class="p">)</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">T2</span> <span class="o">*</span> <span class="n">T1</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">))</span> <span class="c1"># NOT commutative</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
True
True
True
False
</pre></div>
</div>
</div>
</div>
<p>Finally, 3D transforms can act on 3D points, which we can do using matrix multiplication, or using the <code class="docutils literal notranslate"><span class="pre">Pose3.transformFrom</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P1</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Point3</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P0 = </span><span class="si">{</span><span class="n">T</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># need to make P0 homogeneous</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P0 = </span><span class="si">{</span><span class="n">T</span><span class="o">.</span><span class="n">transformFrom</span><span class="p">(</span><span class="n">P1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P0 = [-3.21400437  0.50261322  6.          1.        ]
P0 = [-3.21400437  0.50261322  6.        ]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="angular-velocity">
<h2><span class="section-number">7.1.4. </span>Angular Velocity<a class="headerlink" href="#angular-velocity" title="Permalink to this headline">¶</a></h2>
<p>The linear velocity of the origin of a moving frame is easy to understand.
This velocity is obtained merely by computing the derivative of the coordinate vector for the frame’s origin.
The derivative of orientation is more interesting.</p>
<p>We begin by introducing the family of <span class="math notranslate nohighlight">\(3 \times 3\)</span> skew symmetric matrices, denoted by <span class="math notranslate nohighlight">\(\mathfrak{so}(3)\)</span>.
The relationship between <span class="math notranslate nohighlight">\(\mathfrak{so}(3)\)</span> and <span class="math notranslate nohighlight">\(SO(3)\)</span> will become apparent shortly.
A matrix <span class="math notranslate nohighlight">\(S\)</span> is said to be a <strong>skew symmetric matrix</strong> if</p>
<div class="math notranslate nohighlight">
\[
S + S^T = 0
\]</div>
<p>If we examine this equation for each element of <span class="math notranslate nohighlight">\(S\)</span>, we obtain nine equations,</p>
<div class="math notranslate nohighlight">
\[ s_{i,j} = - s_{j,i}, ~~~~ i,j = 1,2,3 \]</div>
<p>When <span class="math notranslate nohighlight">\(i=j\)</span>, we have <span class="math notranslate nohighlight">\(s_{ii} = -s_{ii}\)</span>, which is satisfied only if <span class="math notranslate nohighlight">\(s_{ii} = 0\)</span>.
Thus, the diagonal elements of a skew symmetric matrix are all zeros.
The remaining equations constrain the off-diagonal entries, such that
every <span class="math notranslate nohighlight">\(S \in so(3)\)</span> can be written as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\hat{s} = S =
\begin{bmatrix}
0 &amp; -s_z &amp;s_y \\
s_z &amp; 0 &amp; -s_x \\
-s_y &amp; s_x &amp; 0
\end{bmatrix}
\end{split}\]</div>
<p>Note that we define the <strong>hat operator</strong> <span class="math notranslate nohighlight">\(\hat{\cdot}\)</span>, which maps a vector <span class="math notranslate nohighlight">\(s = (s_x, s_y, s_z)\)</span> to
a skew symmetric matrix as above.</p>
<p>Skew symmetric matrices play a key role in representing the angular rate of change of coordinate frames.
Let <span class="math notranslate nohighlight">\(R(t)\)</span> be a time-varying rotation matrix.
Because <span class="math notranslate nohighlight">\(R(t) \in SO(3)\)</span>, at each time <span class="math notranslate nohighlight">\(t\)</span> we have <span class="math notranslate nohighlight">\(R^T(t) R(t) = I\)</span>.
If we differentiate both sides of this equation, we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\frac{d}{dt} \left[ R^T(t) R(t) \right] &amp;= \frac{d}{dt} I  \\
     \dot{R}^T R + R^T \dot{R} &amp;= 0
\end{aligned}
\end{split}\]</div>
<p>In other words, <span class="math notranslate nohighlight">\(R^T \dot{R} = - \dot{R}^T R\)</span> and hence the matrix <span class="math notranslate nohighlight">\(R^T \dot{R}\)</span> <em>is a skew symmetric matrix</em></p>
<div class="math notranslate nohighlight">
\[R^T \dot{R} = \hat{\omega}\]</div>
<p>with <span class="math notranslate nohighlight">\(\omega\)</span> some three-vector. Multiplying by <span class="math notranslate nohighlight">\(R\)</span> on both sides immediately gives an equation of <span class="math notranslate nohighlight">\(\dot{R}\)</span> in terms of <span class="math notranslate nohighlight">\(\omega\)</span>:</p>
<div class="math notranslate nohighlight">
\[\dot{R} = R \hat{\omega}.\]</div>
<p>The above gives an expression for the derivative of a rotation matrix <span class="math notranslate nohighlight">\(\dot{R}\)</span> that
will be used below in our formulation of drone dynamics.
The vector <span class="math notranslate nohighlight">\(\omega\)</span> is called the <strong>angular velocity</strong>,
and it is indeed the same angular velocity that you may have
learned in an introductory physics course.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="S70_drone_intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">7. </span>Autonomous Drones in 3D</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="S72_drone_actions.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7.2. </span>Multi-rotor Aircraft</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Frank Dellaert and Seth Hutchinson<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>